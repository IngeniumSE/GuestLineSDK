// This work is licensed under the terms of the MIT license.
// For a copy, see <https://opensource.org/licenses/MIT>.

namespace GuestLineSDK.Primitives;

using System.Text.Json.Serialization;

/// <summary>
/// Provides a base class for API result models that include status, error information, and tracking identifiers.
/// </summary>
/// <remarks>This class is intended to be used as a base for strongly-typed API result objects, enabling
/// consistent handling of status, error descriptions, and tracking IDs across different response types. It is commonly
/// used in scenarios where API responses need to be deserialized and processed in a uniform manner.</remarks>
/// <typeparam name="TResult">The type of the derived result class. Must inherit from GuestLineResultBase<TResult>.</typeparam>
public abstract class Result<TResult>
	: Model<TResult>
	where TResult : Result<TResult>
{
	[JsonPropertyName("status")]
	public string? Status { get; set; }

	[JsonPropertyName("error_desc")]
	public string? Error { get; set; }

	[JsonPropertyName("trackingId")]
	public string? TrackingId { get; set; }
}

/// <summary>
/// Represents a standardized error response returned by the API when an operation fails.
/// </summary>
/// <remarks>Use this type to convey error details to clients in a consistent format. Inherits common result
/// properties from <see cref="Result{T}"/>.</remarks>
public class ErrorResponse : Result<ErrorResponse>
{
	/// <summary>
	/// Gets or sets the source of the error, indicating whether it originated from the SDK or the API.
	/// </summary>
	[JsonPropertyName("error_source")]
	public ErrorSource ErrorSource { get; set; } = ErrorSource.API;

	/// <summary>
	/// Gets or sets the exception associated with the current operation, if one occurred.
	/// </summary>
	/// <remarks>If no exception was thrown during the operation, this property will be <see langword="null"/>. This
	/// property can be used to inspect error details when an operation fails.</remarks>
	public Exception? Exception { get; set; }
}

/// <summary>
/// Specifies the origin of an error encountered during an operation.
/// </summary>
/// <remarks>Use this enumeration to distinguish whether an error was generated by the client SDK or by the remote
/// API. This can help in diagnosing issues and determining the appropriate handling or reporting strategy.</remarks>
public enum ErrorSource
{
	/// <summary>
	/// Denotes errors coming from the SDK itself, such as validation failures or client-side exceptions.
	/// </summary>
	SDK,

	/// <summary>
	/// Denotes errors returned by the remote API, such as HTTP errors or API-specific error responses.
	/// </summary>
	API
}
